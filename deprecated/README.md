# Deprecated Files - DO NOT USE

**Date Deprecated:** November 27, 2025
**Reason:** Data integrity issues - systematic double-counting errors

---

## ⚠️ WARNING: These Files Contain Errors

All files in this directory have been deprecated due to **confirmed data quality issues** identified in the November 27, 2025 audit (see Gemini's data integrity report).

## Why These Files Were Deprecated

### Critical Issues Found

1. **Double-Counting Investment** (115% overcounting)
   - Scripts sum `award_amount` across all rows
   - Dataset has multiple rows per project
   - Result: Same project counted 2-3 times

2. **Double-Counting Students** (90% overcounting)
   - Scripts sum student counts across all rows
   - Same students counted multiple times per project

3. **Misleading Filenames**
   - `01_comprehensive_roi_analysis_CORRECTED.ipynb` - NOT actually corrected!
   - Claims to be fixed but contains original flawed logic

4. **Unreliable Data Source**
   - Some notebooks use `fact sheet data.xlsx` without Project ID
   - Cannot deduplicate reliably
   - May contain hidden duplicates

---

## Files in This Directory

### `deprecated/notebooks/`

| File | Issue | Use Instead |
|------|-------|-------------|
| `01_comprehensive_roi_analysis.ipynb` | Double-counting errors | `analysis/notebooks/01_comprehensive_roi_analysis_FIXED.ipynb` |
| `01_comprehensive_roi_analysis_CORRECTED.ipynb` | **MISLEADING** - not actually corrected | `analysis/notebooks/01_comprehensive_roi_analysis_FIXED.ipynb` |
| `02_roi_visualizations.ipynb` | Uses fact sheet without warnings | Updated version with warnings in analysis/notebooks/ |
| `03_interactive_html_visualizations.ipynb` ⚠️ **NEW** | Uses fact sheet without Project ID - cannot deduplicate reliably | Needs complete rewrite with IWRCDataLoader |
| `04_fact_sheet_static_charts.ipynb` ⚠️ **NEW** | Uses fact sheet without Project ID - cannot deduplicate reliably | Needs complete rewrite with IWRCDataLoader |
| `05_project_type_breakdown.ipynb` ⚠️ **CRITICAL** | Lines 191-194, 286-287, 322-323, 419-425 - systematic double-counting | Needs complete rewrite with IWRCDataLoader |
| `06_interactive_breakdown.ipynb` ⚠️ **CRITICAL** | Lines 237-240 - multiple .sum() calls without deduplication | Needs complete rewrite with IWRCDataLoader |

### `deprecated/scripts/`

| File | Issue | Use Instead |
|------|-------|-------------|
| `generate_final_deliverables.py` | Lines 90, 142, 194 have double-counting | `analysis/scripts/generate_all_visualizations_CORRECTED.py` |
| `generate_final_deliverables_v2.py` | Same issues as above | `analysis/scripts/generate_all_visualizations_CORRECTED.py` |
| `regenerate_analysis.py` | Lines 145-146 (investment), 275-283 (students) - double-counting | `analysis/scripts/regenerate_analysis_CORRECTED.py` |
| `generate_comprehensive_documentation.py` | Lines 89-90 (investment), 138-146 (students) - double-counting | Needs complete rewrite with IWRCDataLoader |
| `generate_dual_track_deliverables.py` | Line 162+ (investment sums), student sums - double-counting throughout | Needs complete rewrite with IWRCDataLoader |
| `generate_static_visualizations.py` | Hardcoded wrong values | `analysis/scripts/generate_static_visualizations_CORRECTED.py` |
| `generate_fresh_reports.py` ⚠️ **NEW** | Lines 115, 117, 139 - `.sum()` without deduplication | `analysis/scripts/generate_fresh_reports_CORRECTED.py` |
| `generate_pdf_reports_stage4.py` ⚠️ **NEW** | Lines 106-122 - all metric calculations use `.sum()` without deduplication | `analysis/scripts/generate_pdf_reports_stage4_CORRECTED.py` |
| `stage5_excel_and_documentation.py` ⚠️ **NEW** | Lines 94-167 - student/investment sums without groupby deduplication | `analysis/scripts/stage5_excel_and_documentation_CORRECTED.py` |

### `deprecated/visualizations/interactive/`

| File | Issue | Use Instead |
|------|-------|-------------|
| ⚠️ **Old versions replaced** | Interactive dashboards from deprecated notebook 06 had double-counting | Use fresh files generated by `generate_interactive_dashboards_CORRECTED.py` |

---

## What To Use Instead

### ✅ Corrected Files (Safe to Use)

**Notebooks:**
- `analysis/notebooks/01_comprehensive_roi_analysis_FIXED.ipynb`

**Scripts:**
- `analysis/scripts/generate_all_visualizations_CORRECTED.py`
- `analysis/scripts/generate_static_visualizations_CORRECTED.py`
- `analysis/scripts/iwrc_data_loader.py` (new centralized module)

**Documentation:**
- `docs/METHODOLOGY_CORRECTED.md`
- `docs/FINDINGS_CORRECTED.md`
- `docs/DATA_QUALITY_AUDIT_REPORT.md`

### Master Index
See `CORRECTED_FILES_INDEX.md` for complete list of safe vs deprecated files.

---

## Technical Details

### The Double-Counting Error

**Root Cause:** The consolidated Excel file has multiple rows per project:

```
Project_ID    Award_Amount    Output
2020IL103B    $50,000        Publication A
2020IL103B    $50,000        Publication B
2020IL103B    $50,000        Grant Award
2020IL103B    $50,000        Presentation
```

**Wrong Code (in deprecated files):**
```python
investment = df['award_amount'].sum()
# Result: $50,000 × 4 rows = $200,000 ❌
```

**Correct Code (in fixed files):**
```python
investment = df.groupby('project_id')['award_amount'].first().sum()
# Result: $50,000 × 1 project = $50,000 ✅
```

### Impact

| Metric | Deprecated Files (Wrong) | Correct Files |
|--------|-------------------------|---------------|
| 10-Year Investment | $8,516,278 | $3,958,980 |
| 10-Year Students | 304 | 160 |
| 10-Year ROI | 3% | 7% |

---

## Migration Instructions

If you have workflows using deprecated files:

1. **Stop using deprecated files immediately**
2. **Switch to corrected versions** (see table above)
3. **Use centralized data loader:** `iwrc_data_loader.py`
4. **Read migration guide:** `docs/MIGRATION_FROM_FACT_SHEET.md`
5. **Verify metrics match corrected values** (see above table)

---

## Why Not Delete?

These files are **deprecated** (not deleted) because:

1. **Reversibility** - Can restore if needed
2. **Historical Record** - Shows what was wrong
3. **Audit Trail** - Supports data quality documentation
4. **Safety** - Less risky than permanent deletion

---

## Questions?

**For technical details:**
- See: `docs/DATA_QUALITY_AUDIT_REPORT.md`
- See: Gemini's integrity report (provided to team)

**For corrected methodology:**
- See: `docs/METHODOLOGY_CORRECTED.md`

**For migration help:**
- See: `docs/MIGRATION_FROM_FACT_SHEET.md`

---

**Last Updated:** November 27, 2025
**Audit Reference:** Gemini Data Integrity Report
